
import { getKLineData } from '@/api/tradingView';

 //周期对照 key: tv内部周期  value: 请求参数
 const cycleObject = {

    '1': '1min',
    '3': '3min',
    '5': '5min',
    '15': '15min',
    '30': '30min',
    '60': '1hour',
    '120': '2hour',
    '240': '4hour',
    '360': '6hour',
    '720': '12hour',
    '1D': '1day',
    '3D': '3day',
    '1W': '7day',
    '1M': '30day',
}

const langObj = {

    cn: 'zh',
    hk: 'zh_TW',
    en: 'en',
    ja: 'ja',
    ko: 'ko',
    ar: 'ar',
    th: 'th',
    ru: 'ru',
}

class DataFeed{

    constructor(content) {
        this.tvObj = content;
    }

    onReady(callback) {

        var configurationData = {

            supported_resolutions: this.tvObj.getInterval('ak'),
            supports_marks: false,
            supports_search: false,
            supports_timescale_marks: false,
            supports_time: false,
        }
        setTimeout(function () {
            callback(configurationData)
        }, 0)
    }

    searchSymbols(userInput, exchange, symbolType, onResultReadyCallback) {

        console.log('DataFeed-----searchSymbols');
        var data = [
            {
                symbol: this.tvObj.Config.market,
                full_name: this.tvObj.Config.market,
                description: this.tvObj.Config.market,
                exchange: 'XT.COM',
                ticker: this.tvObj.Config.market,
                type: 'bitcoin',
            },
        ];

        setTimeout(function () {
            onResultReadyCallback(data)
        }, 0)
    }

    resolveSymbol(symbolName, onSymbolResolvedCallback, onResolveErrorCallback) {

        console.log('DataFeed-----resolveSymbol');
        var config = this.tvObj.Config;
        var data = {
            name: "BTC/USDT",
            ticker: config.market,
            minmov: 1,
            pricescale: Math.pow(10, parseInt(config.mConfig.moneyDecimal)),
            timezone: "Asia/Singapore",
            // timezone: jstz.determine().name(),
            has_intraday: true, //true才正常
            has_daily: true,
            has_weekly_and_monthly: true,
            session: '24x7',
            volume_precision: 2,
        }
        setTimeout(function () {
            onSymbolResolvedCallback(data)
        }, 0)
    }

    /**
     * K线图表体数据获取并渲染
     * @param {*} symbolInfo 
     * @param {*} resolution 
     * @param {*} from 
     * @param {*} to 
     * @param {*} onHistoryCallback  数据渲染回调函数
     * @param {*} onErrorCallback 
     * @param {*} firstDataRequest 
     */
    getBars(symbolInfo, resolution, from, to, onHistoryCallback, onErrorCallback, firstDataRequest) {


        let tv = this.tvObj;
        //取周期
        if (tv.tvWidget) {
            if (tv.tvWidget.symbolInterval().interval != tv.Interval) {
                tv.KLineHistoryFlag = true;
            }
            tv.Interval = tv.tvWidget.symbolInterval().interval

        }
        const param = {
            event: 'request',
            method: 'getChartData',
            channel: "",
            market: tv.Config.market,
            //since : tv.RangeEndDate,
            from: from,
            to: to,
            interval: tv.getInterval(tv.Interval),
        }
        // getChartData 迁移后产生的数据
        // getKLineHistory 迁移xt数据
        const success = function (res) {

            var datas = res.data.datas || res.data.records || [];
            // 过滤掉错误市场、周期数据
            if (
                res.data.market !== param.market
                || res.data.interval !== param.interval
            ) {
                onHistoryCallback([], {noData: true})
                return false
            }
            // tv.RangeEndDate = res.data.since;
            if (firstDataRequest) {
                //只有第一次全量请求才记录最后时间戳 溯源数据不更新时间戳
                if (to > tv.RangeEndDate) {
                    tv.RangeEndDate = res.data.since
                }
            }

            // if (0 === datas.length) {
            //     tv.KLineHistoryFlag = false;
            //     tv.getKLineHistory(param, success2);
            // } else {
            //历史数据
            let temp = datas.map(function (item) {
                return tv.formatChartData(item)
            });

            console.log("getBars------data-websocket--format-------", temp);
            onHistoryCallback(temp, {noData: 0 === datas.length})
            // }
        }

        const success2 = function (res) {

            console.log("getBars------data-websocket2-------", res);
            var datas = res.data.datas || res.data.records || []

            // 过滤掉错误市场、周期数据
            if (
                res.data.market !== param.market ||
                res.data.interval !== param.interval
            ) {
                return false
            }
            // tv.RangeEndDate = res.data.since;
            if (firstDataRequest) {
                //只有第一次全量请求才记录最后时间戳 溯源数据不更新时间戳
                if (to > tv.RangeEndDate) {
                    tv.RangeEndDate = res.data.since
                    // console.log('full chart init: ', res.data.since);
                }
            }

            //历史数据
            var temp = datas.map(function (item) {
                return tv.formatChartData(item)
            })


            onHistoryCallback(temp, {noData: 0 === datas.length})
        }

        if (tv.KLineHistoryFlag) {
            tv.getChartData(param, success)
        } else {
            tv.getKLineHistory(param, success2)
        }
    }

    /**
     * 订阅websocket 实时更新数据
     * @param {*} symbolInfo 
     * @param {*} resolution 
     * @param {*} onRealtimeCallback 
     * @param {*} subscriberUID 
     * @param {*} onResetCacheNeededCallback 
     */
    subscribeBars(symbolInfo, resolution, onRealtimeCallback, subscriberUID, onResetCacheNeededCallback) {

        // console.log('DataFeed-----subscribeBars');
        // const tv = this.tvObj;
        // //取周期
        // if (tv.tvWidget) {
        //     tv.Interval = tv.tvWidget.symbolInterval().interval;
        // }

        // var param = {

        //     event: 'addChannel',
        //     channel: _Socket.channel.chart,
        //     market: tv.Config.market,
        //     since: tv.RangeEndDate,
        //     interval: tv.getInterval(tv.Interval),
        // }

        // //初始化推送
        // tv.socketInit = false;
        // //更新频道名
        // tv.socketMark = _Socket.getChannelName(param);
        // //成功回调
        // var success = function (res) {

        //     console.log("subscribeBars------data-websocket-------", res);
        //     var datas = res.data.datas || res.data.records
        //     // 过滤掉错误市场、周期数据
        //     if ( res.data.market !== param.market || res.data.interval !== param.interval )return false;

        //     // 过滤掉不合法的数据
        //     datas = datas.filter(function (item) {
        //         // console.log('filter: ', item);
        //         return item[0] >= tv.RangeEndDate
        //     })

        //     //格式化数据
        //     var temp = datas.map(function (item) {
        //         return tv.formatChartData(item)
        //     });

        //     //更新时间戳
        //     param.since = res.data.since;
        //     tv.RangeEndDate = res.data.since;
        //     //若有多个新数据遍历更新
        //     for (var i = 0, ilen = temp.length; i < ilen; i++) {
        //         onRealtimeCallback(temp[i])
        //     }
        // }
        // var taskInterval = function () {

        //     if (_Socket && _Socket.openWebSocket && !tv.socketInit) {

        //         //console.log('subscribeBars socket');
        //         _Socket.addChannel({...param, isFull: false}, success)
        //         tv.socketInit = true
        //     }
        //     if (!_Socket || !_Socket.openWebSocket || !tv.socketInit) {

        //         //console.log('subscribeBars http');
        //         tv.getChartData(param, success)
        //         tv.socketInit = false
        //     }
        // }
        // taskInterval()
        // tv.taskInterval = setInterval(taskInterval, 2000)
    }

    unsubscribeBars(subscriberUID) {

        console.log('DataFeed-----unsubscribeBars');
        this.tvObj.unsubscribeBars()
    }

    calculateHistoryDepth(resolution, resolutionBack, intervalBack) {}

    getMarks(symbolInfo, startDate, endDate, onDataCallback, resolution){}

    getTimescaleMarks(symbolInfo, startDate, endDate, onDataCallback, resolution){}

    getServerTime(callback){}

    getQuotes(symbols, onDataCallback, onErrorCallback){}

    subscribeQuotes(symbols, fastSymbols, onRealtimeCallback, listenerGUID){}

    unsubscribeQuotes(listenerGUID){}

    subscribeDepth(symbolInfo, callback){}

    unsubscribeDepth(subscriberUID){}

}

class HmsTradingView {
    
    constructor() {

        /** 传入的配置  */
        this.Config = null;

        /** 图表数据 */
        this.Data = '';

        /**全量数据初始化状态*/
        this.DataInit = false;

        /** 最早的时间戳 */
        this.RangeStartDate = 0;

        /** 最后的时间戳 */
        this.RangeEndDate = 0;

        /** 是否新对接 */ 
        this.isXT3 = false;

        /** 当前的周期  默认30分钟*/
        this.Interval = '30';

        /** 历史K线开关 假设getChartData一直有数据(true),当没有数据时(false)，再请求getKLineHistory */
        this.KLineHistoryFlag = true;

        /** 定时器 */
        this.taskInterval = null;

        this.tvWidget = null;

        /** 周期按钮 */
        this.IntervalButton = {

            min: {

                defText: this.LANG('分钟'),
                list: [
                    {name: `1${this.LANG('分钟')}`, resolution: '1'},
                    {name: `3${this.LANG('分钟')}`, resolution: '3'},
                    {name: `5${this.LANG('分钟')}`, resolution: '5'},
                    {name: `15${this.LANG('分钟')}`, resolution: '15'},
                    {name: `30${this.LANG('分钟')}`, resolution: '30'},
                ],
                active: ['1', '3', '5', '15', '30'],
            },

            hour: {

                defText: this.LANG('小时'),
                list: [
                    {name: `1${this.LANG('小时')}`, resolution: '60'},
                    {name: `2${this.LANG('小时')}`, resolution: '120'},
                    {name: `4${this.LANG('小时')}`, resolution: '240'},
                    {name: `6${this.LANG('小时')}`, resolution: '360'},
                    {name: `12${this.LANG('小时')}`, resolution: '720'},
                ],
                active: ['60', '120', '240', '360', '720'],
            },

            day: {

                defText: this.LANG('天'),
                list: [
                    {name: `1${this.LANG('天')}`, resolution: '1D'},
                    {name: `3${this.LANG('天')}`, resolution: '3D'},
                ],
                active: ['1D', '3D'],
            },

            weeks: {

                defText: this.LANG('周线'),
                list: [],
                active: ['1W'],
            },

            month: {

                defText: this.LANG('月线'),
                list: [],
                active: ['1M'],
            },
        };

        this.dataFeed = new DataFeed(this);

    }
    /**
     * 语言国际化，待封装
     * @param {*} str 
     * @returns 
     */
    LANG(str) {
        return str;
    }
    init(config={}) {

        const {isXT3 = false} = config;
        this.isXT3 = isXT3;
        if (!config) {

            console.log('chart init miss market config.')
            return false;
        }

        this.Config = config;
        //取周期，切换市场
        if (this.tvWidget) {

            this.Interval = this.tvWidget.symbolInterval().interval
            this.tvWidget.setSymbol(config.market, this.Interval)
        } else {

            this.tvWidget = new TradingView.widget(this.getConfig(config))

            this.tvWidget.onChartReady(function () {

                console.log("widget----onChartReady");
                if (!this.tvWidget) {
                    return false
                }
                this.tvWidget
                    .chart()
                    .createStudy('Moving Average', false, false, [5], null, {
                        'Plot.color': '#43bedc',
                        'Plot.linewidth': 2,
                    })
                this.tvWidget
                    .chart()
                    .createStudy('Moving Average', false, false, [15], null, {
                        'Plot.color': '#be43dc',
                        'Plot.linewidth': 2,
                    })
                this.tvWidget
                    .chart()
                    .createStudy('Moving Average', false, false, [30], null, {
                        'Plot.color': '#eebb93',
                        'Plot.linewidth': 2,
                    })
            })
        }
    }

    /**
     * 转换周期数据
     * @param {*} name 
     * @returns 
     */
    getInterval(name) {
       
        //  name: ak 所有key  av 所有value
        if(name === 'ak') {
            return Object.keys(cycleObject);
        }
        else if(name === 'av') {
            return Object.values(cycleObject);
        }
        else {
            return cycleObject[name];
        }
    }

    /**
     * 
     * @param {*} type 
     */
    kLineActive(type) {

        if(!this.tvWidget) return;
        this.tvWidget.chart().executeActionById(type);
    }

    getLANG() {

        return 'zh';
        // return langObj[LAN] || 'en'
    }

    /**
     * 数据获取
     * @param {*} option 
     * @param {*} callback 
     */
    getChartData(option, callback) {

        // request.post('/table/tableList', data);
        console.log("getChartData-------");
        // getKLineData().then(res => {
        //     console.log("chartData-------", res);
        //     callback && callback(res);
        // });
        let record = [[1618569000,60279.44,60279.49,60276.05,60276.05,0.41,24713.90],
    
            [   1618570800,
                "60276.050000000000000",
                "60276.050000000000000",
                "60276.050000000000000",
                "60276.050000000000000",
                0,
                0
            ],
            [
                1618572600,
                "60276.050000000000000",
                "60276.050000000000000",
                "60276.050000000000000",
                "60276.050000000000000",
                0,
                0
            ],
            [
                1618574400,
                "60276.050000000000000",
                "60276.050000000000000",
                "60276.050000000000000",
                "60276.050000000000000",
                0,
                0
            ],
            [
                1618576200,
                "60821.500000000000000",
                "60822.490000000000000",
                "60753.920000000000000",
                "60756.190000000000000",
                "1.600000000000000",
                "97259.895200000000000"
            ],
            [
                1618578000,
                "60655.470000000000000",
                "60980.590000000000000",
                "222.000000000000000",
                "222.000000000000000",
                "53.670000000000000",
                "2785412.357000000000000"
            ],
            [
                1618579800,
                "222.000000000000000",
                "2222.000000000000000",
                "222.000000000000000",
                "2222.000000000000000",
                "12.000000000000000",
                "10664.000000000000000"
            ],
            [
                1618581600,
                "2222.000000000000000",
                "2222.000000000000000",
                "2222.000000000000000",
                "2222.000000000000000",
                0,
                0
            ],
            [
                1618599600,
                "2222.000000000000000",
                "2222.000000000000000",
                "2222.000000000000000",
                "2222.000000000000000",
                0,
                0
            ][
                1618795800,
                "56521.780000000000000",
                "56521.780000000000000",
                "56521.780000000000000",
                "56521.780000000000000",
                0,
                0
            ],
            [
                1618797600,
                "56521.780000000000000",
                "56521.780000000000000",
                "56521.780000000000000",
                "56521.780000000000000",
                0,
                0
            ],
            [
                1618799400,
                "56521.780000000000000",
                "56521.780000000000000",
                "56521.780000000000000",
                "56521.780000000000000",
                0,
                0
            ],
            [
                1618801200,
                "56521.780000000000000",
                "56521.780000000000000",
                "56521.780000000000000",
                "56521.780000000000000",
                0,
                0
            ],
            [
                1618803000,
                "56521.780000000000000",
                "56521.780000000000000",
                "56521.780000000000000",
                "56521.780000000000000",
                0,
                0
            ],
            [
                1618804800,
                "56908.360000000000000",
                "56908.370000000000000",
                "56908.360000000000000",
                "56908.370000000000000",
                "0.190000000000000",
                "10812.590200000000000"
            ],
            [
                1618806600,
                "56908.370000000000000",
                "56908.370000000000000",
                "56908.370000000000000",
                "56908.370000000000000",
                0,
                0
            ],
            [
                1618808400,
                "56547.730000000000000",
                "56553.960000000000000",
                "56424.320000000000000",
                "56429.030000000000000",
                "0.570000000000000",
                "32210.778500000000000"
            ],
            [
                1618810200,
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                0,
                0
            ],
            [
                1618812000,
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                0,
                0
            ],
            [
                1618813800,
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                0,
                0
            ],
            [
                1618815600,
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                0,
                0
            ],
            [
                1618817400,
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                0,
                0
            ],
            [
                1618819200,
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                0,
                0
            ],
            [
                1618821000,
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                "56429.030000000000000",
                0,
                0
            ],
            [
                1618822800,
                "56722.770000000000000",
                "56818.730000000000000",
                "56680.020000000000000",
                "56818.700000000000000",
                "3.230000000000000",
                "183460.954500000000000"
            ],
            [
                1618824600,
                "56983.200000000000000",
                "56994.480000000000000",
                "56973.230000000000000",
                "56977.470000000000000",
                "15.080000000000000",
                "859298.493000000000000"
            ],
            [
                1618826400,
                "56977.470000000000000",
                "56977.470000000000000",
                "56977.470000000000000",
                "56977.470000000000000",
                0,
                0
            ],
            [
                1618828200,
                "56279.700000000000000",
                "56279.700000000000000",
                "56279.700000000000000",
                "56279.700000000000000",
                "1.000000000000000",
                "56279.700000000000000"
            ],
            [
                1618830000,
                "56876.660000000000000",
                "56876.660000000000000",
                "1111.000000000000000",
                "56833.340000000000000",
                "154.130000000000000",
                "1800257.478200000000000"
            ],
            [
                1618831800,
                "56961.920000000000000",
                "57287.650000000000000",
                "56961.920000000000000",
                "57064.130000000000000",
                "42.560000000000000",
                "2429649.520100000000000"
            ],
            [
                1618833600,
                "57026.800000000000000",
                "57118.580000000000000",
                "56864.108900000000000",
                "56981.748600000000000",
                "18.840000000000000",
                "1074606.179548000000000"
            ],
            [
                1618835400,
                "56992.918900000000000",
                "57141.627900000000000",
                "56462.538700000000000",
                "56501.872400000000000",
                "16.430000000000000",
                "932898.641824000000000"
            ],
            [
                1618837200,
                "56490.165800000000000",
                "60000.000000000000000",
                "56038.798600000000000",
                "56359.300000000000000",
                "30.120000000000000",
                "1705627.534226000000000"
            ],
            [
                1618839000,
                "56405.560000000000000",
                "56739.000000000000000",
                "56319.970000000000000",
                "56623.630000000000000",
                "33.070000000000000",
                "1869742.077500000000000"
            ],
            [
                1618840800,
                "56605.850000000000000",
                "56605.850000000000000",
                "55742.600000000000000",
                "55742.600000000000000",
                "21.890000000000000",
                "1232953.944900000000000"
            ],
            [
                1618842600,
                "55743.000000000000000",
                "55908.780000000000000",
                "55138.300000000000000",
                "55423.480000000000000",
                "8.070000000000000",
                "447975.126100000000000"
            ],
            [
                1618844400,
                "55423.540000000000000",
                "55423.540000000000000",
                "54778.020000000000000",
                "55350.680000000000000",
                "6.070000000000000",
                "334629.346200000000000"
            ],
            [
                1618846200,
                "55350.520000000000000",
                "55350.590000000000000",
                "54262.190000000000000",
                "54569.210000000000000",
                "6.020000000000000",
                "329790.374000000000000"
            ],
            [
                1618848000,
                "54569.350000000000000",
                "55545.190000000000000",
                "54411.950000000000000",
                "55229.200000000000000",
                "5.600000000000000",
                "308597.951000000000000"
            ],
            [
                1618849800,
                "55229.240000000000000",
                "55317.800000000000000",
                "54693.460000000000000",
                "54835.950000000000000",
                "6.200000000000000",
                "340694.548800000000000"
            ],
            [
                1618851600,
                "54835.820000000000000",
                "55403.330000000000000",
                "54581.770000000000000",
                "55258.520000000000000",
                "4.610000000000000",
                "253925.182600000000000"
            ],
            [
                1618853400,
                "55258.550000000000000",
                "55423.930000000000000",
                "55085.370000000000000",
                "55361.300000000000000",
                "5.510000000000000",
                "304522.465100000000000"
            ],
            [
                1618855200,
                "55361.440000000000000",
                "55795.630000000000000",
                "55324.360000000000000",
                "55581.480000000000000",
                "4.820000000000000",
                "267931.804100000000000"
            ],
            [
                1618857000,
                "55581.470000000000000",
                "55733.640000000000000",
                "55391.300000000000000",
                "55636.100000000000000",
                "5.890000000000000",
                "327518.206300000000000"
            ],
            [
                1618858800,
                "55635.620000000000000",
                "55862.570000000000000",
                "55571.540000000000000",
                "55692.270000000000000",
                "4.610000000000000",
                "256736.058300000000000"
            ],
            [
                1618860600,
                "55591.620000000000000",
                "56060.220000000000000",
                "55397.860000000000000",
                "55933.390000000000000",
                "5.200000000000000",
                "289921.969700000000000"
            ],
            [
                1618862400,
                "55933.590000000000000",
                "56088.480000000000000",
                "55768.460000000000000",
                "56053.300000000000000",
                "5.260000000000000",
                "294241.648300000000000"
            ],
            [
                1618864200,
                "56053.490000000000000",
                "56386.020000000000000",
                "56053.490000000000000",
                "56124.890000000000000",
                "4.270000000000000",
                "240041.066100000000000"
            ],
            [
                1618866000,
                "56125.320000000000000",
                "56219.690000000000000",
                "55786.930000000000000",
                "55786.930000000000000",
                "5.220000000000000",
                "292769.108800000000000"
            ],
            [
                1618867800,
                "55786.940000000000000",
                "56515.190000000000000",
                "55733.710000000000000",
                "56240.330000000000000",
                "5.810000000000000",
                "326512.653400000000000"
            ],
            [
                1618869600,
                "56240.290000000000000",
                "56240.290000000000000",
                "55962.750000000000000",
                "56079.360000000000000",
                "6.400000000000000",
                "358871.084100000000000"
            ],
            [
                1618871400,
                "56079.460000000000000",
                "56293.750000000000000",
                "55866.000000000000000",
                "56014.410000000000000",
                "7.780000000000000",
                "436679.252400000000000"
            ],
            [
                1618873200,
                "56015.010000000000000",
                "56180.850000000000000",
                "55560.180000000000000",
                "55598.790000000000000",
                "5.420000000000000",
                "302972.778100000000000"
            ],[
                1618875000,
                "55598.640000000000000",
                "55875.840000000000000",
                "55585.750000000000000",
                "55648.060000000000000",
                "4.670000000000000",
                "260197.752000000000000"
            ],
            [
                1618876800,
                "55648.170000000000000",
                "55789.490000000000000",
                "54809.040000000000000",
                "54831.030000000000000",
                "7.000000000000000",
                "386890.682300000000000"
            ],
            [
                1618878600,
                "54830.870000000000000",
                "54939.550000000000000",
                "54405.660000000000000",
                "54599.700000000000000",
                "6.910000000000000",
                "377813.309200000000000"
            ],
            [
                1618880400,
                "54599.900000000000000",
                "55108.410000000000000",
                "54599.900000000000000",
                "54976.170000000000000",
                "4.200000000000000",
                "230744.781900000000000"
            ],
            [
                1618882200,
                "54976.200000000000000",
                "54976.390000000000000",
                "54496.890000000000000",
                "54850.750000000000000",
                "4.440000000000000",
                "243110.982300000000000"
            ],
            [
                1618884000,
                "54851.060000000000000",
                "54875.140000000000000",
                "53807.300000000000000",
                "53875.140000000000000",
                "4.540000000000000",
                "247647.469000000000000"
            ],
            [
                1618885800,
                "53875.120000000000000",
                "54139.410000000000000",
                "53624.530000000000000",
                "54139.400000000000000",
                "4.560000000000000",
                "245825.699600000000000"
            ],
            [
                1618887600,
                "54139.420000000000000",
                "54368.160000000000000",
                "54065.900000000000000",
                "54204.870000000000000",
                "5.280000000000000",
                "286409.733800000000000"
            ],
            [
                1618889400,
                "54253.620000000000000",
                "54772.200000000000000",
                "54136.560000000000000",
                "54535.900000000000000",
                "1310.468900090000000",
                "71455461.139534458000000"
            ],
            [
                1618891200,
                "54521.900000000000000",
                "55069.000000000000000",
                "54381.200000000000000",
                "54669.700000000000000",
                "1217.293381700000000",
                "66626130.691498539000000"
            ],
            [
                1618893000,
                "54687.200000000000000",
                "55322.400000000000000",
                "54641.600000000000000",
                "55253.500000000000000",
                "1157.385121140000000",
                "63557224.717595841000000"
            ],
            [
                1618894800,
                "55253.600000000000000",
                "55439.400000000000000",
                "54857.500000000000000",
                "54972.400000000000000",
                "913.546258480000000",
                "50355332.931108616000000"
            ],
            [
                1618896600,
                "54970.800000000000000",
                "55123.000000000000000",
                "54754.900000000000000",
                "54934.000000000000000",
                "835.804566830000000",
                "45917643.043955719000000"
            ],
            [
                1618898400,
                "54934.000000000000000",
                "55161.000000000000000",
                "54421.580000000000000",
                "54515.100000000000000",
                "108.014958880000000",
                "5922800.224920333000000"
            ],
            [
                1618900200,
                "54517.800000000000000",
                "54684.600000000000000",
                "53533.400000000000000",
                "53821.200000000000000",
                "155.459359430000000",
                "8410138.559715560000000"
            ],
            [
                1618902000,
                "53840.600000000000000",
                "54249.000000000000000",
                "53526.200000000000000",
                "53851.600000000000000",
                "169.797086180000000",
                "9157945.615308208000000"
            ],
            [
                1618903800,
                "53851.600000000000000",
                "54420.900000000000000",
                "53339.600000000000000",
                "54371.400000000000000",
                "195.133180310000000",
                "10529559.102989491000000"
            ],
            [
                1618905600,
                "54368.900000000000000",
                "55074.000000000000000",
                "54003.940000000000000",
                "54732.800000000000000",
                "159.836248410000000",
                "8730128.486086322000000"
            ],
            [
                1618907400,
                "54732.700000000000000",
                "55310.600000000000000",
                "54383.940000000000000",
                "55245.300000000000000",
                "62.062302660000000",
                "3407312.099900602000000"
            ],
            [
                1618909200,
                "55245.300000000000000",
                "55430.500000000000000",
                "54830.700000000000000",
                "55217.100000000000000",
                "33.707008610000000",
                "1857618.176250056000000"
            ],
            [
                1618911000,
                "55234.300000000000000",
                "55298.800000000000000",
                "54775.400000000000000",
                "54857.000000000000000",
                "56.290638750000000",
                "3098760.516585941000000"
            ],
            [
                1618912800,
                "54854.600000000000000",
                "55916.200000000000000",
                "54826.600000000000000",
                "55631.200000000000000",
                "72.130673210000000",
                "4000825.912027830000000"
            ],
            [
                1618914600,
                "55631.100000000000000",
                "56221.200000000000000",
                "55603.300000000000000",
                "55921.100000000000000",
                "72.035705020000000",
                "4030755.244015042000000"
            ],
            [
                1618916400,
                "55912.000000000000000",
                "56110.000000000000000",
                "55747.500000000000000",
                "55800.500000000000000",
                "39.092587160000000",
                "2185805.620378311000000"
            ],
            [
                1618918200,
                "55815.500000000000000",
                "56425.700000000000000",
                "55656.900000000000000",
                "56273.900000000000000",
                "64.131428110000000",
                "3590164.893620588000000"
            ],
            [
                1618920000,
                "56273.900000000000000",
                "56288.700000000000000",
                "55630.100000000000000",
                "55743.900000000000000",
                "47.835513400000000",
                "2677669.575836333000000"
            ],
            [
                1618921800,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618923600,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618925400,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618927200,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618929000,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618930800,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618932600,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618934400,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618936200,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618938000,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618939800,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618941600,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618943400,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618945200,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618947000,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618948800,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618950600,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618952400,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618954200,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618956000,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618957800,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618959600,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618961400,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618963200,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618965000,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618966800,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618968600,
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                "55743.900000000000000",
                0,
                0
            ],
            [
                1618970400,
                "56000.290000000000000",
                "56000.290000000000000",
                "56000.290000000000000",
                "56000.290000000000000",
                "0.050000000000000",
                "2800.014500000000000"
            ],
            [
                1618972200,
                "56082.430000000000000",
                "56228.360000000000000",
                "56082.420000000000000",
                "56128.400000000000000",
                "13.856488870000000",
                "778205.162492466000000"
            ],
            [
                1618974000,
                "56128.400000000000000",
                "56170.500000000000000",
                "55641.100000000000000",
                "55739.100000000000000",
                "189.811053110000000",
                "10629481.089247898000000"
            ],
            [
                1618975800,
                "55746.300000000000000",
                "55853.400000000000000",
                "55442.600000000000000",
                "55469.300000000000000",
                "92.356876200000000",
                "5141752.411034921000000"
            ],
            [
                1618977600,
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                0,
                0
            ],
            [
                1618979400,
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                0,
                0
            ],
            [
                1618981200,
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                0,
                0
            ],
            [
                1618983000,
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                0,
                0
            ],
            [
                1618984800,
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                0,
                0
            ],
            [
                1618986600,
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                0,
                0
            ],
            [
                1618988400,
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                0,
                0
            ],
            [
                1618990200,
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                "55469.300000000000000",
                0,
                0
            ],
            [
                1618992000,
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                "0.056854000000000",
                "3145.325313900000000"
            ],
            [
                1618993800,
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                0,
                0
            ],
            [
                1618995600,
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                0,
                0
            ],
            [
                1618997400,
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                0,
                0
            ],
            [
                1618999200,
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                0,
                0
            ],
            [
                1619001000,
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                0,
                0
            ],
            [
                1619002800,
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                0,
                0
            ],
            [
                1619004600,
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                0,
                0
            ],
            [
                1619006400,
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                0,
                0
            ],
            [
                1619008200,
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                "55322.850000000000000",
                0,
                0
            ],
            [
                1619010000,
                "55331.160000000000000",
                "55482.000000000000000",
                "55299.400000000000000",
                "55444.900000000000000",
                "54.745871330000000",
                "3032376.960083292000000"
            ],
            [
                1619011800,
                "55444.900000000000000",
                "55694.200000000000000",
                "55412.100000000000000",
                "55575.400000000000000",
                "44.119150740000000",
                "2451395.397400081000000"
            ],
            [
                1619013600,
                "55575.400000000000000",
                "55634.300000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "7.608210560000000",
                "423063.492869773000000"
            ],
            [
                1619015400,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619017200,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619019000,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619020800,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619022600,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619024400,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619026200,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619028000,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619029800,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619031600,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619033400,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619035200,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619037000,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619038800,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619040600,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619042400,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619044200,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619046000,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619047800,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619049600,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619051400,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619053200,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619055000,
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                "55534.900000000000000",
                0,
                0
            ],
            [
                1619056800,
                "53735.000000000000000",
                "53759.900000000000000",
                "52777.000000000000000",
                "53500.900000000000000",
                "373.559429020000000",
                "19855076.853594347000000"
            ],
            [
                1619058600,
                "53508.300000000000000",
                "53935.300000000000000",
                "53344.500000000000000",
                "53800.300000000000000",
                "211.535733900000000",
                "11365572.385638459000000"
            ],
            [
                1619060400,
                "53800.300000000000000",
                "54190.000000000000000",
                "53704.800000000000000",
                "53858.300000000000000",
                "160.739236030000000",
                "8679224.308276803000000"
            ],
            [
                1619062200,
                "53858.300000000000000",
                "53936.000000000000000",
                "53348.800000000000000",
                "53494.900000000000000",
                "143.037397720000000",
                "7669866.484052687000000"
            ],];
        let res = {
            "code":200,
            "data":{
                "market":"btc_usdt",
                "interval":"30min",
                "since":"1620788400000",
                "records": record
            }
        }
        callback && callback(res);
        // const BASE_URL = this.isXT3 ? DOMAIN_XTQUOTATION : DOMAIN_TRADE + API_PATH + API_VERSION;
        // _Method.ajax({

        //     url: BASE_URL + '/getChartData',
        //     data: {
        //         market: option.market,
        //         from: option.from,
        //         to: option.to,
        //         since: option.since,
        //         interval: option.interval,
        //     },
        //     success: function (res) {
        //         callback && callback(res)
        //     },
        // })
    }

    /**
     * 
     * @param {*} option 
     * @param {*} callback 
     */
    getKLineHistory(option, callback) {

        //TODO
        // _Method.ajax({

        //     url: DOMAIN_TRADE + API_PATH + API_VERSION + '/getKLineHistory',
        //     data: {
        //         market: option.market,
        //         from: option.from,
        //         to: option.to,
        //         since: option.since,
        //         interval: option.interval,
        //     },
        //     success: function (res) {
        //         callback && callback(res)
        //     },
        // })
    }

    /**
     * 格式化数组格式的K线数据
     * @param {*} array 
     * @returns 
     */
    formatChartData(array) {

        if (!array || array.length !== 7)  return {};
           
        return {
            time: array[0] * 1000,
            open: array[1],
            high: array[2],
            low: array[3],
            close: array[4],
            volume: array[5],
            volume2: array[6],
        };
    }

    getConfig(config) {

        const lightOverrides = {

            volumePaneSize: 'small',
            'paneProperties.background': '#fff', // 中间背景颜色
            'paneProperties.legendProperties.showLegend': false,
            'scalesProperties.lineColor': '#eee',
            'scalesProperties.textColor': '#333',
            'paneProperties.horzGridProperties.color': '#eee',
            'mainSeriesProperties.candleStyle.upColor': '#00C186',
            'mainSeriesProperties.candleStyle.downColor': '#FF5761',
            'mainSeriesProperties.candleStyle.borderUpColor': '#00C186',
            'mainSeriesProperties.candleStyle.borderDownColor': '#FF5761',
            'mainSeriesProperties.candleStyle.wickUpColor': '#00C186',
            'mainSeriesProperties.candleStyle.wickDownColor': '#FF5761',
        }
        const darkOverrides = {

            'paneProperties.background': '#161616', // 中间背景颜色
            //'scalesProperties.lineColor': '#eee',
            //'scalesProperties.textColor': '#333',
            'paneProperties.vertGridProperties.color': 'rgba(51, 51, 51,.7)', // 网格竖线
            'paneProperties.horzGridProperties.color': 'rgba(51, 51, 51,.7)', // 网格竖线
            'mainSeriesProperties.candleStyle.upColor': '#00C186', // k线图的柱形颜色 涨
            'mainSeriesProperties.candleStyle.downColor': '#FF5761', // k线图的柱形颜色 跌
            'mainSeriesProperties.candleStyle.drawWick': true,
            'mainSeriesProperties.candleStyle.drawBorder': false,
            'mainSeriesProperties.candleStyle.borderUpColor': '#00C186', // hover的字体颜色变化
            'mainSeriesProperties.candleStyle.borderDownColor': '#FF5761',
            'mainSeriesProperties.candleStyle.wickUpColor': '#00C186',
            'mainSeriesProperties.candleStyle.wickDownColor': '#FF5761',
            'mainSeriesProperties.candleStyle.barColorsOnPrevClose': false,
            'mainSeriesProperties.areaStyle.color1': 'rgba(39,56,68,.3)',
            'mainSeriesProperties.areaStyle.color2': 'rgba(39,56,68,.3)',
            'mainSeriesProperties.areaStyle.linecolor': '#7291a1',
            'mainSeriesProperties.areaStyle.linestyle': 0,
            'mainSeriesProperties.areaStyle.linewidth': 1,
            'mainSeriesProperties.areaStyle.priceSource': 'close',
            'mainSeriesProperties.barStyle.dontDrawOpen': false,
            'scalesProperties.lineColor': 'rgba(51, 51, 51,.7)', // 网格外的边框颜色
            'scalesProperties.textColor': '#666', // 减号出来后的字体
        }

        return {

            debug: false,
            container_id: config.containerId,
            custom_css_url: '/src/css/chart-sytle.css',
            library_path: '/charting_library/',
            locale: this.getLANG(),
            datafeed: this.dataFeed,
            symbol: config.market,
            interval: this.Interval,
            timezone: "Asia/Singapore",
            // timezone: jstz.determine().name(),
            theme: config.theme,
            width: '100%',
            height: '100%',
            toolbar_bg: config.theme === 'Dark' ? '#161616' : '#fff', // 外围背景颜色
            volumePaneSize: 'small',
            overrides: config.theme === 'Dark' ? darkOverrides : lightOverrides,
            studies_overrides: {
                'volume.show ma': true,
                'volume.volume.transparency': '53',
                'volume.volume ma.plottype': 'line',
            },
            disabled_features: [
                //禁用的扩展功能
                'header_widget',
                'timeframes_toolbar', //底部工具条
                'use_localstorage_for_settings',
                'save_chart_properties_to_local_storage',
                'show_interval_dialog_on_key_press',
                'symbol_search_hot_key',
                'edit_this.buttons_in_legend',
                'volume_force_overlay',
                'header_interval_dialog_button',
                'header_symbol_search',
                'header_saveload',
                'header_screenshot',
                'header_chart_type',
                'header_compare',
                'header_undo_redo',
                'hide_left_toolbar_by_default',
                'header_resolutions',
            ],
            enabled_features: [
                'dont_show_boolean_study_arguments',
                'move_logo_to_main_pane',
                'disable_resolution_rebuild',
                'countdown',
                'header_screenshot',
                'header_settings',
                'hide_last_na_study_output',
                'same_data_requery',
                'hide_left_toolbar_by_default',
            ],
            // favorites: {
            //   intervals: ['1', '5', '15', '30', '60', '720', 'D'],
            // },
            loading_screen: {
                // 加载时过渡
                backgroundColor: config.theme === 'Dark' ? '#161616' : '#fff',
                foregroundColor: '#f5c059',
            },
        }
    }

    unsubscribeBars() {

        this.RangeEndDate = 0
        //移除旧频道
        if (this.socketInit) {
            _Socket.removeChannel(this.socketMark)
        }
        if (this.taskInterval) {
            clearInterval(this.taskInterval)
        }
    }

    remove() {

        this.unsubscribeBars();
        this.tvWidget = null;
    }

    changeTheme(theme) {

        var lightOverrides = {

            volumePaneSize: 'small',
            'paneProperties.background': '#fff', // 中间背景颜色
            // 'paneProperties.legendProperties.showLegend': false,
            'scalesProperties.lineColor': '#eee',
            'scalesProperties.textColor': '#333',
            'mainSeriesProperties.candleStyle.upColor': '#00C186',
            'mainSeriesProperties.candleStyle.downColor': '#FF5761',
            'mainSeriesProperties.candleStyle.borderUpColor': '#00C186',
            'mainSeriesProperties.candleStyle.borderDownColor': '#FF5761',
            'mainSeriesProperties.candleStyle.wickUpColor': '#00C186',
            'mainSeriesProperties.candleStyle.wickDownColor': '#FF5761',
            'paneProperties.vertGridProperties.color': '#eeeeee', // 网格竖线
            'paneProperties.horzGridProperties.color': '#eeeeee', // 网格竖线
        }

        var darkOverrides = {

            volumePaneSize: 'small',
            'paneProperties.background': '#161616', // 中间背景颜色
            'paneProperties.vertGridProperties.color': 'rgba(51, 51, 51,.7)', // 网格竖线
            'paneProperties.horzGridProperties.color': 'rgba(51, 51, 51,.7)', // 网格竖线
            'mainSeriesProperties.candleStyle.upColor': '#00C186', // k线图的柱形颜色 涨
            'mainSeriesProperties.candleStyle.downColor': '#FF5761', // k线图的柱形颜色 跌
            'mainSeriesProperties.candleStyle.drawWick': true,
            'mainSeriesProperties.candleStyle.drawBorder': false,
            'mainSeriesProperties.candleStyle.borderUpColor': '#00C186', // hover的字体颜色变化
            'mainSeriesProperties.candleStyle.borderDownColor': '#FF5761',
            'mainSeriesProperties.candleStyle.wickUpColor': '#00C186',
            'mainSeriesProperties.candleStyle.wickDownColor': '#FF5761',
            'mainSeriesProperties.candleStyle.barColorsOnPrevClose': false,
            'mainSeriesProperties.areaStyle.color1': 'rgba(39,56,68,.3)',
            'mainSeriesProperties.areaStyle.color2': 'rgba(39,56,68,.3)',
            'mainSeriesProperties.areaStyle.linecolor': '#7291a1',
            'mainSeriesProperties.areaStyle.linestyle': 0,
            'mainSeriesProperties.areaStyle.linewidth': 1,
            'mainSeriesProperties.areaStyle.priceSource': 'close',
            'mainSeriesProperties.barStyle.dontDrawOpen': false,
            'scalesProperties.lineColor': 'rgba(51, 51, 51,.7)', // 网格外的边框颜色
            'scalesProperties.textColor': '#666', // 减号出来后的字体
        }
        this.tvWidget.changeTheme(theme)
        if (theme === 'Dark') {
            // 需要延时执行覆盖样式，否则无法生效
            setTimeout(() => {
                this.tvWidget.applyOverrides(darkOverrides)
            }, 0)
        } else {
            setTimeout(() => {
                this.tvWidget.applyOverrides(lightOverrides)
            }, 0)
        }
    }

}

export { HmsTradingView };